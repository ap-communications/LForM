## input ##

<source>
  @id forti_syslog
  @type tail
  path /var/log/APC/local6_forti.log
  pos_file  /var/log/APC/local6_forti.pos
  tag syslog.forti
  <parse>
    @type fortigate_syslog
  </parse>
  #format fortigate_syslog
</source>

## output ##
<match syslog_security.forti>
  @type copy

  <store>
    @type  elasticsearch
    host 127.0.0.1
    port 9200
    scheme https
    ssl_verify true
    ssl_version TLSv1_2
    #ca_file /etc/elasticsearch/certs/ca.crt
    client_cert /etc/td-agent/certs/td-agent_instance.crt
    client_key  /etc/td-agent/certs/td-agent_instance.key
    logstash_format true
    logstash_prefix forti_syslog_log_001_security
    logstash_dateformat %Y%m%d
    buffer_chunk_limit 8m
    buffer_queue_limit 256
    @id fortitraffic_to_elasticsearch_syslog_security
    buffer_type file
    buffer_path /var/lib/fluentd_buffer/forti_security_buf
    use_legacy_template true
    <buffer>
      flush_interval 5s
    </buffer>
  </store>

  #<store>
  #  type stdout
  #</store>

</match>

<match syslog_traffic.forti>
  @type copy

  <store>
    @type  elasticsearch
    host 127.0.0.1
    port 9200
    scheme https
    ssl_verify true
    ssl_version TLSv1_2
    #ca_file /etc/elasticsearch/certs/node1-http.p12
    client_cert /etc/td-agent/certs/td-agent_instance.crt
    client_key  /etc/td-agent/certs/td-agent_instance.key
    logstash_format true
    logstash_prefix forti_syslog_log_001_traffic
    logstash_dateformat %Y%m%d
    buffer_chunk_limit 8m
    buffer_queue_limit 256
    @id fortitraffic_to_elasticsearch_syslog_traffic
    buffer_type file
    buffer_path /var/lib/fluentd_buffer/forti_traffic_buf
    <buffer>
      flush_interval 5s
    </buffer>
  </store>

</match>

#<match **>
#  type stdout
#</match>
